definitions:
  handlers.CameraListResponse:
    properties:
      cameras:
        items:
          $ref: '#/definitions/handlers.CameraResponse'
        type: array
      total:
        example: 3
        type: integer
    type: object
  handlers.CameraResponse:
    properties:
      camera_id:
        example: test-camera
        type: string
      message:
        example: Camera started successfully
        type: string
      status:
        example: started
        type: string
      stream_url:
        example: rtsp://wowzaec2demo.streamlock.net/vod/mp4:BigBuckBunny_115k.mp4
        type: string
      timestamp:
        example: "2025-07-28T19:45:51Z"
        type: string
    type: object
  handlers.CameraStatusResponse:
    properties:
      active:
        example: true
        type: boolean
      camera_id:
        example: test-camera
        type: string
      last_seen:
        example: "2025-07-28T19:45:51Z"
        type: string
      processing_info:
        additionalProperties: true
        type: object
      status:
        example: running
        type: string
      stream_info:
        additionalProperties: true
        type: object
      uptime:
        example: 5m30s
        type: string
      webrtc_info:
        additionalProperties: true
        type: object
    type: object
  handlers.HealthResponse:
    properties:
      status:
        example: healthy
        type: string
      worker_id:
        example: worker-1
        type: string
    type: object
  handlers.StartCameraRequest:
    properties:
      solutions:
        example:
        - person_detection
        - ppe_detection
        items:
          type: string
        type: array
      stream_url:
        example: rtsp://wowzaec2demo.streamlock.net/vod/mp4:BigBuckBunny_115k.mp4
        type: string
    required:
    - solutions
    - stream_url
    type: object
  handlers.StreamURLsResponse:
    properties:
      camera_id:
        example: test-camera
        type: string
      hls:
        example: http://127.0.0.1:8888/camera_test-camera/index.m3u8
        type: string
      rtsp:
        example: rtsp://127.0.0.1:8554/camera_test-camera
        type: string
      webrtc:
        example: http://127.0.0.1:8889/camera_test-camera/whep
        type: string
    type: object
info:
  contact: {}
paths:
  /cameras:
    get:
      consumes:
      - application/json
      description: Get list of all cameras and their status
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.CameraListResponse'
      summary: List all cameras
      tags:
      - cameras
  /cameras/{id}/start:
    post:
      consumes:
      - application/json
      description: Start processing for a camera with RTSP stream
      parameters:
      - description: Camera ID
        in: path
        name: id
        required: true
        type: string
      - description: Camera configuration
        in: body
        name: camera
        required: true
        schema:
          $ref: '#/definitions/handlers.StartCameraRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.CameraResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Conflict
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Start camera processing
      tags:
      - cameras
  /cameras/{id}/status:
    get:
      consumes:
      - application/json
      description: Get detailed status of a specific camera
      parameters:
      - description: Camera ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.CameraStatusResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get camera status
      tags:
      - cameras
  /cameras/{id}/stop:
    post:
      consumes:
      - application/json
      description: Stop processing for a camera
      parameters:
      - description: Camera ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.CameraResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Stop camera processing
      tags:
      - cameras
  /health:
    get:
      consumes:
      - application/json
      description: Check if the worker is healthy and responsive
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.HealthResponse'
      summary: Health check
      tags:
      - health
  /webrtc/{id}/urls:
    get:
      consumes:
      - application/json
      description: Get streaming URLs for all formats (HLS, WebRTC, RTSP) for a camera
      parameters:
      - description: Camera ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.StreamURLsResponse'
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "503":
          description: Service Unavailable
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get stream URLs
      tags:
      - webrtc
  /webrtc/stats:
    get:
      consumes:
      - application/json
      description: Get WebRTC publishing statistics for a camera or all cameras
      parameters:
      - description: Camera ID (optional, returns all if not specified)
        in: query
        name: id
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "503":
          description: Service Unavailable
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get WebRTC statistics
      tags:
      - webrtc
swagger: "2.0"
